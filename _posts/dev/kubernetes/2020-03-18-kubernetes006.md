---
title: "KUB-24 #4 쿠버네티스 클러스터 직접 구성"
date: 2020-03-17 00:00:00 +0800
categories: kubernetes
tag: 
- container
- orchestration
- kubeadm
- kubespray
sidebar:
  title: "Development"
  nav: "dev-sidebar"
---
쿠버네티스를 직접 구성해야 할 때를 대비하여 직접 구성하는 방법을 알아보겠습니다. <br>

### 1. 대표적인 도구

#### 1.1 Kubeadm

- 쿠버네티스에서 공식 제공하는 클러스터 생성/관리 도구
- 여러 대의 마스터 노드 구성에 로드밸런서를 두는 구조

#### 1.2 Kubespray

- 상용 서비스에 적합한 보안성과 고가용성이 있는 오픈 소스 프로젝트
- 서버 환경 설정 자동화 도구인 앤서블 기반으로 개발
- ingress-nginx, helm, cephfs 등 추가 구성 요소를 클러스터에 실행하는 역할 수행

### 2. 실습 인프라 구성

#### 2.1 VM 생성

실습은 kubespray를 설치하는 것으로 하고 환경은 GCP로 하겠습니다.
Google Cloud Platform에 접속하여 VM 인스턴스 만들기를 클릭합니다. <br>

![KUB24001](/assets/images/kubenetes/KUB24001.png)

실습에서 Ubuntu 16.04 LTS를 사용 할 예정으로 부팅 디스크는 Ubuntu 16.04 LTS에 버전에 맞춰서 설정합니다 <br>

![KUB24001](/assets/images/kubenetes/KUB24002.png)

인스턴스 생성은 총 5개를 만듭니다.

![KUB24001](/assets/images/kubenetes/KUB24003.png)

**참고 사항** GCP는 최근에 서울 리전이 생겼는데 서울 리전을 선택해서 인스턴스를 만들었더니만 오류가 납니다. 
아직 안되나 봅니다.
{: .notice--primary}

#### 2.2 SSH 키 생성과 배포

instance-1 노드를 마스터노드#1로 정하고 해당 노드와 나머지 VM간 ssh 접근을 위해 설정을 수행합니다. <br>

먼저, 마스터 노드(instance-1)에 콘솔로 접속합니다. <br>
접속한 마스터 노드의 ssh 키를 생성합니다. <br>

![KUB24001](/assets/images/kubenetes/KUB24004.png)

생성된 마스터 노드의 ssh 키를 Compute Engine > 메타데이터 메뉴에 등록합니다. <br>

![KUB24001](/assets/images/kubenetes/KUB24005.png)